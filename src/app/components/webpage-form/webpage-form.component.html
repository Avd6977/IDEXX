<div class="webpage-form-container">
    <h2>Add New Webpage</h2>

    <form
        [formGroup]="webpageForm"
        (ngSubmit)="onSubmit()"
        class="webpage-form"
    >
        <div class="form-group">
            <label for="url">URL *</label>
            <input
                type="url"
                id="url"
                formControlName="url"
                class="form-control"
                [class.is-invalid]="url?.invalid && url?.touched"
                placeholder="https://example.com"
            />

            @if (url?.invalid && url?.touched) {
                <div class="invalid-feedback">
                    @if (url?.errors?.['required']) {
                        <div>URL is required</div>
                    }
                    @if (url?.errors?.['pattern']) {
                        <div>Please enter a valid URL</div>
                    }
                </div>
            }
        </div>

        <div class="form-group">
            <label for="title">Title</label>
            <input
                type="text"
                id="title"
                formControlName="title"
                class="form-control"
                placeholder="Website title"
            />
        </div>

        <div class="form-group">
            <label for="description">Description</label>
            <textarea
                id="description"
                formControlName="description"
                class="form-control"
                rows="3"
                placeholder="Brief description of the website"
            ></textarea>
        </div>

        <div class="form-group">
            <label for="publishDate">Publish Date (Optional)</label>
            <input
                type="date"
                id="publishDate"
                formControlName="publishDate"
                class="form-control"
                [min]="minDate"
            />
            <small class="form-text">Select today or any future date</small>
        </div>

        <div class="form-group">
            <label for="imageFile">Image (Optional)</label>
            <div class="image-upload-container">
                <input
                    type="file"
                    id="imageFile"
                    #imageFileInput
                    (change)="onImageSelected($event)"
                    accept="image/*"
                    class="image-input"
                />
                <label for="imageFile" class="image-upload-label">
                    ðŸ“· Choose Image
                </label>
                @if (imagePreview) {
                    <div class="image-preview">
                        <img [src]="imagePreview" alt="Preview" />
                        <button
                            type="button"
                            class="btn-remove-image"
                            (click)="removeImage()"
                            title="Remove image"
                        >
                            âœ•
                        </button>
                    </div>
                }
                @if (selectedImageName) {
                    <small class="form-text">{{ selectedImageName }}</small>
                }
            </div>
        </div>

        <div class="form-actions">
            <button
                type="submit"
                class="btn btn-primary"
                [disabled]="webpageForm.invalid || isLoading"
            >
                @if (isLoading) {
                    <span class="loading-spinner"></span>
                }
                {{ isLoading ? 'Saving...' : 'Save Webpage' }}
            </button>

            <button
                type="button"
                class="btn btn-secondary"
                (click)="resetForm()"
            >
                Reset
            </button>
        </div>
    </form>

    @if (formStatus) {
        <div class="form-status">
            <div
                class="alert"
                [class.alert-success]="formStatus.type === 'success'"
                [class.alert-error]="formStatus.type === 'error'"
            >
                {{ formStatus.message }}
            </div>
        </div>
    }
</div>
